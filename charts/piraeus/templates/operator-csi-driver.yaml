{{- if .Values.csi.enabled }}
apiVersion: piraeus.linbit.com/v1alpha1
kind: LinstorCSIDriver
metadata:
  name: {{ template "operator.fullname" . }}
spec:
  enabled: {{ .Values.csi.enabled }}
  imagePullSecret: {{ .Values.drbdRepoCred | quote }}
  linstorPluginImage: {{ .Values.csi.pluginImage | quote }}
  csiAttacherImage: {{ .Values.csi.csiAttacherImage | quote }}
  csiNodeDriverRegistrarImage: {{ .Values.csi.csiNodeDriverRegistrarImage | quote }}
  csiProvisionerImage: {{ .Values.csi.csiProvisionerImage | quote }}
  csiSnapshotterImage: {{ .Values.csi.csiSnapshotterImage | quote }}
  linstorHttpsClientSecret: {{ .Values.linstorHttpsClientSecret | quote }}
  priorityClassName: {{ .Values.priorityClassName | default "" | quote }}
  {{- if empty .Values.linstorHttpsClientSecret }}
  controllerEndpoint: http://{{ template "operator.fullname" . }}-cs.{{ .Release.Namespace }}.svc:3370
  {{- else }}
  controllerEndpoint: https://{{ template "operator.fullname" . }}-cs.{{ .Release.Namespace }}.svc:3371
  {{- end }}
  {{- end }}
